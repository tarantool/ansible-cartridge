---

- name: 'Forced gathering facts'
  setup:
  when: module_setup is not defined
  tags:
    - cartridge-instances
    - cartridge-replicasets
    - cartridge-config

- name: 'Validate config and hosts'
  import_tasks: 'validate.yml'
  tags:
    - cartridge-instances
    - cartridge-replicasets
    - cartridge-config

- name: 'Prepare facts'
  import_tasks: 'prepare.yml'
  tags:
    - cartridge-instances
    - cartridge-replicasets
    - cartridge-config

- name: 'BLOCK : Import tasks by scenario'
  include_tasks: "{{ item.path }}"
  loop_control:
    label: "{{ item.name }}"
  with_items: "{{ scenario_steps }}"
  tags:
    - cartridge-instances
    - cartridge-replicasets
    - cartridge-config
