---
dependency:
  name: galaxy

driver:
  name: docker

platforms:
  - name: vm1
    hostname: host1
    image: centos:7
    command: /sbin/init
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    published_ports:
      - 8081-8090:8081-8090/tcp
    networks:
      - name: cartridge-network
    purge_networks: true
  - name: vm2
    hostname: host2
    # XXX: wait for Tarantool fix
    # image: jrei/systemd-ubuntu
    # command: /lib/systemd/systemd
    image: centos:7
    command: /sbin/init
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    published_ports:
      - 8091-8099:8091-8099/tcp
    networks:
      - name: cartridge-network
    purge_networks: true
    privileged: true

provisioner:
  name: ansible
  lint:
    name: ansible-lint

  inventory:
    links:
      hosts: hosts.yml

      #     cartridge_bootstrap_vshard: true
      #     cartridge_failover: true

      #     cartridge_auth:
      #       enabled: true

      #       cookie_max_age: 1000
      #       cookie_renew_age: 100

      #       users:
      #         - username: tarantool
      #           password: tarantool-the-best
      #           fullname: Tarantool The Best
      #           email: tarantool@tarantool.org

      #     cartridge_app_config:
      #       section-1:
      #         body:
      #           key-1: value-1
      #           key-2: value-2

      #       section-2:
      #         body: section-2-value

      #       section-3:
      #         deleted: true

      #     cartridge_replicasets:
      #       - name: storage-1
      #         instances:
      #           - storage_1
      #           - storage_1_replica
      #           - storage_1_replica_2
      #         leader: storage_1
      #         roles: ['vshard-storage']

      #       - name: core-1
      #         instances:
      #           - core_1
      #         roles: ['app.roles.custom', 'vshard-router']

verifier:
  name: testinfra
  lint:
    name: flake8
    options:
      max-line-length: 120
